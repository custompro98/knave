---

---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Knave</title>
  </head>
  <script>
    // Helper function
    /** @ts-ignore-next-line */
    let domReady = (cb) => {
      document.readyState === "interactive" ||
      document.readyState === "complete"
        ? cb()
        : document.addEventListener("DOMContentLoaded", cb);
    };

    domReady(() => {
      // Display body when DOM is readed
      document.body.style.visibility = "visible";
    });
  </script>
  <body class="flex min-h-screen flex-col" style="visibility: hidden">
    <header
      class="flex h-24 flex-row items-center justify-center bg-black p-4 text-white"
    >
      <h1 class="font-heading text-5xl font-bold tracking-wide">Knave</h1>
    </header>
    <main class="mb-auto">
      <section class="mx-auto max-w-screen-xl p-4" x-data="{ knaves: knaves }">
        <div class="flex flex-row justify-between pb-2">
          <h2 class="font-heading text-3xl tracking-tight">Knaves</h2>
        </div>
        <div class="grid grid-cols-1 gap-2 md:grid-cols-3">
          <div
            class="flex min-h-[26.25rem] max-w-sm cursor-pointer flex-col items-center justify-center border-2 border-black p-2 shadow-bold"
            x-on:click="knaves = [rollKnave(), ...knaves]"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.0"
              stroke="currentColor"
              class="size-20 text-black"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 4.5v15m7.5-7.5h-15"></path>
            </svg>
          </div>
          <template x-for="knave in knaves">
            <div
              class="flex max-w-sm flex-col border-2 border-black p-2 shadow-bold"
            >
              <div class="flex flex-row items-center justify-between">
                <div>
                  <h3 class="font-serif text-xl" x-text="knave.name"></h3>
                </div>
                <div
                  class="flex flex-row items-center gap-2 text-sm text-black/75"
                >
                  <span class="font-serif">
                    Level: <span x-text="knave.level"></span>
                  </span>
                  <span class="font-serif">
                    XP: <span x-text="knave.xp"></span>
                  </span>
                </div>
              </div>
              <div class="flex flex-row gap-1 pb-2 text-sm text-black/75">
                <span>Former</span>
                <span class="lowercase" x-text="knave.firstCareer"></span>
              </div>
              <div class="grid grid-cols-3 gap-2 pb-2">
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">STR</h4>
                  <span class="text-lg" x-text="knave.str"></span>
                </div>
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">DEX</h4>
                  <span class="text-lg" x-text="knave.dex"></span>
                </div>
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">CON</h4>
                  <span class="text-lg" x-text="knave.con"></span>
                </div>
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">INT</h4>
                  <span class="text-lg" x-text="knave.int"></span>
                </div>
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">WIS</h4>
                  <span class="text-lg" x-text="knave.wis"></span>
                </div>
                <div class="flex flex-col items-center justify-center">
                  <h4 class="text-sm text-black/75">CHA</h4>
                  <span class="text-lg" x-text="knave.cha"></span>
                </div>
              </div>
              <div class="mb-auto">
                <h4 class="text-lg">Inventory</h4>
                <div class="grid grid-cols-2 gap-2">
                  <template x-for="(item, index) in knave.items">
                    <div
                      class="flex flex-row items-center gap-1"
                      x-id="['text-input']"
                    >
                      <label
                        class="text-sm text-black/75"
                        :for="$id('text-input')"
                      >
                        <span x-text="index + 1"></span><span>.</span>
                      </label>
                      <input
                        class="max-w-40 border border-gray-200/75"
                        type="text"
                        x-model="item"
                        :id="$id('text-input')"
                        :name="$id('text-input')"
                      />
                    </div>
                  </template>
                </div>
              </div>
              <div class="flex flex-row items-center justify-center gap-2 pt-4">
                <button
                  x-on:click="knaves = knaves.filter((pred) => pred.id !== knave.id); deleteKnave(knave.id)"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="size-6 text-red-500"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                    ></path>
                  </svg>
                </button>
                <button x-on:click="upsertKnave(knave)">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="size-6 text-blue-500"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"
                    ></path>
                  </svg>
                </button>
              </div>
            </div>
          </template>
        </div>
      </section>
    </main>
    <footer class="flex h-24 flex-row items-center justify-center bg-black p-4">
      <span class="text-white">
        Buy <span class="font-heading">Knave</span> on <a
          class="text-blue-500 hover:underline"
          href="https://www.drivethrurpg.com/en/product/484910/knave-second-edition"
          >DriveThruRPG</a
        >
      </span>
    </footer>
  </body>

  <script>
    import Alpine from "alpinejs";
    import { rollOnTable } from "knave-2e-generator";
    import {
      type Knave,
      rollKnave,
      upsertKnave,
      readKnaves,
      deleteKnave,
    } from "../scripts/knaves";

    declare global {
      interface Window {
        Alpine: typeof Alpine;

        knaves: Knave[];

        rollKnave: () => Knave;
        upsertKnave: (uuid: Knave) => void;
        deleteKnave: (uuid: string) => void;

        rollMonster: () => ReturnType<typeof rollOnTable>;
        rollMonsterTrait: () => ReturnType<typeof rollOnTable>;
        rollScent: () => ReturnType<typeof rollOnTable>;
        rollWeakness: () => ReturnType<typeof rollOnTable>;
      }
    }

    window.Alpine = Alpine;
    window.rollKnave = rollKnave;
    window.upsertKnave = upsertKnave;
    window.deleteKnave = deleteKnave;
    window.knaves = readKnaves();
  </script>
  <style is:global>
    [x-cloak] {
      display: none !important;
    }

    @font-face {
      font-family: "SebaldusGotisch";
      src: url("/fonts/SebaldusGotisch.ttf") format("truetype");
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
  </style>
</html>
